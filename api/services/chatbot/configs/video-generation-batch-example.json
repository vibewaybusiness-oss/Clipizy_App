{
  "id": "video-generation-batch",
  "name": "Video Generation with Batch Media Display",
  "description": "Generates multiple video scenes with individual validation",
  "initialStep": "generate_scenes",
  "steps": {
    "generate_scenes": {
      "id": "generate_scenes",
      "stepNumber": 1,
      "bricks": [
        {
          "type": "batch_media_display",
          "id": "batch-scene-generation",
          "generations": [
            {
              "mediaType": "text",
              "label": "Scene 1 Description",
              "endpoint": "/api/ai/generate-scene-description",
              "payload": {
                "scene_number": 1,
                "project_id": "{{workflowData.project_id}}",
                "context": "{{workflowData.videoContext}}"
              },
              "contentPath": "description",
              "regenerationPrice": "{{$text_generation_price}}"
            },
            {
              "mediaType": "image",
              "label": "Scene 1 Visual",
              "endpoint": "/api/ai/generate-scene-image",
              "payload": {
                "scene_number": 1,
                "description": "{{workflowData.scene1Description}}",
                "project_id": "{{workflowData.project_id}}"
              },
              "contentPath": "image_url",
              "regenerationPrice": "{{$image_generation_price}}"
            },
            {
              "mediaType": "video",
              "label": "Scene 1 Video",
              "endpoint": "/api/ai/generate-scene-video",
              "payload": {
                "scene_number": 1,
                "image_url": "{{workflowData.scene1ImageUrl}}",
                "project_id": "{{workflowData.project_id}}"
              },
              "contentPath": "video_url",
              "regenerationPrice": "{{$video_generation_price}}"
            },
            {
              "mediaType": "text",
              "label": "Scene 2 Description",
              "endpoint": "/api/ai/generate-scene-description",
              "payload": {
                "scene_number": 2,
                "project_id": "{{workflowData.project_id}}",
                "context": "{{workflowData.videoContext}}"
              },
              "contentPath": "description",
              "regenerationPrice": "{{$text_generation_price}}"
            },
            {
              "mediaType": "image",
              "label": "Scene 2 Visual",
              "endpoint": "/api/ai/generate-scene-image",
              "payload": {
                "scene_number": 2,
                "description": "{{workflowData.scene2Description}}",
                "project_id": "{{workflowData.project_id}}"
              },
              "contentPath": "image_url",
              "regenerationPrice": "{{$image_generation_price}}"
            },
            {
              "mediaType": "video",
              "label": "Scene 2 Video",
              "endpoint": "/api/ai/generate-scene-video",
              "payload": {
                "scene_number": 2,
                "image_url": "{{workflowData.scene2ImageUrl}}",
                "project_id": "{{workflowData.project_id}}"
              },
              "contentPath": "video_url",
              "regenerationPrice": "{{$video_generation_price}}"
            }
          ],
          "saveKey": "validatedScenes",
          "onComplete": {
            "nextStep": "combine_video",
            "message": "All scenes validated! Creating final video..."
          }
        }
      ],
      "nextStep": "combine_video"
    },

    "combine_video": {
      "id": "combine_video",
      "stepNumber": 2,
      "bricks": [
        {
          "type": "api_call",
          "id": "combine-scenes-backend",
          "endpoint": "/api/ai/combine-scenes",
          "method": "POST",
          "payload": {
            "scenes": "{{workflowData.validatedScenes}}",
            "project_id": "{{workflowData.project_id}}"
          },
          "waitForResponse": true,
          "timeout": 300000,
          "saveResponse": {
            "key": "finalVideoUrl",
            "path": "video_url"
          },
          "onSuccess": {
            "nextStep": "display_final_video"
          }
        },
        {
          "type": "waiting_display",
          "id": "wait-combine",
          "listenTo": "combine-scenes-backend",
          "loadingMessage": "Combining all scenes into final video...",
          "estimatedTime": 60,
          "showProgress": true,
          "onResponse": {
            "success": {
              "message": "Final video ready!",
              "nextStep": "display_final_video"
            }
          }
        }
      ],
      "nextStep": "display_final_video"
    },

    "display_final_video": {
      "id": "display_final_video",
      "stepNumber": 3,
      "bricks": [
        {
          "type": "media_display",
          "id": "final-video-player",
          "mediaType": "video",
          "dataSource": "workflowData.finalVideoUrl",
          "controls": {
            "play": true,
            "seek": true,
            "volume": true,
            "download": true
          },
          "metadata": {
            "title": "Your Generated Video",
            "description": "Final video with all validated scenes"
          },
          "actions": [
            {
              "label": "Download",
              "icon": "download",
              "variant": "outline",
              "action": "download"
            },
            {
              "label": "Complete",
              "variant": "default",
              "nextStep": "end"
            }
          ]
        }
      ],
      "nextStep": "end"
    }
  }
}

