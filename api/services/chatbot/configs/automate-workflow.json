{
  "id": "music_clip_workflow",
  "name": "Music Video Clip",
  "description": "Create a music video clip with AI-generated visuals",
  "initialStep": "llm_health",
  "globalSettings": {
    "autoSave": true,
    "errorHandling": "stop",
    "timeout": 30000
  },
  "steps": {
    "llm_health": {
      "id": "llm_health",
      "stepNumber": 1,
      "bricks": [
        {
          "id": "llm-pod-signal",
          "type": "api_call",
          "endpoint": "/api/v1/ai/runpod/signal-pod",
          "method": "POST",
          "payload": {
            "source": "static",
            "staticData": {"workflow": "llm-ollama"}
          },
          "response": {
            "saveConfig": {
              "key": "llmPodSignal",
              "type": "object",
              "backendKey": "settings",
              "backendType": "dict"
            }
          }
        }
      ],
      "nextStep": "track_input",
      "autoSave": true
    },
    "track_input": {
      "id": "track_input",
      "stepNumber": 1,
      "bricks": [
        {
          "id": "track-upload-input",
          "type": "user_input",
          "inputType": "file",
          "saveConfig": {
            "key": "uploadedAudio",
            "type": "array",
            "backendKey": "tracks",
            "backendType": "list"
          },
          "label": "Upload audio files",
          "accept": "audio/*",
          "multiple": true,
          "maxFiles": 20,
          "validation": {
            "required": false
          }
        },
        {
          "id": "track-actions",
          "type": "llm",
          "buttons": [
            {
              "label": "Generate with AI",
              "action": "generateTrackWithAI",
              "returnValue": "ai_generation",
              "variant": "default"
            }
          ],
          "activatePrompt": false,
          "activateFileUpload": false,
          "assistantMessage": {
            "content": "Great! First, let's get your music track. You can either upload an audio file and quickly describe your creation (genre, mood, etc.). If you don't have an audio file, I can help you generate one.",
            "showDelay": 1200,
            "enableFileInput": true,
            "enablePromptInput": true
          }
        }
      ],
      "nextStep": "video_description",
      "autoSave": true
    },
    "track_ai_description": {
      "id": "track_ai_description",
      "stepNumber": 2,
      "bricks": [
        {
          "id": "music-description-input",
          "type": "user_input",
          "inputType": "text",
          "saveConfig": {
            "key": "musicDescription",
            "type": "string",
            "backendKey": "settings",
            "backendType": "dict"
          },
          "label": "Music Description",
          "placeholder": "Describe the kind of music you want...",
          "validation": {
            "required": true
          }
        },
        {
          "id": "genre-selection",
          "type": "llm",
          "buttons": [
            {
              "label": "Select genre",
              "action": "openGenreSelector",
              "returnValue": "genre_selector",
              "variant": "default",
              "modal": "GenreSelector"
            }
          ],
          "activatePrompt": false,
          "activateFileUpload": false,
          "assistantMessage": {
            "content": "Perfect! Let's create a custom track for you. First, describe the music you want to generate, or I can guide you to write a prompt for it.",
            "showDelay": 1200,
            "enableFileInput": false,
            "enablePromptInput": true
          }
        }
      ],
      "nextStep": "track_ai_lyrics",
      "autoSave": true
    },
    "track_ai_lyrics": {
      "id": "track_ai_lyrics",
      "stepNumber": 3,
      "bricks": [
        {
          "id": "lyrics-input",
          "type": "user_input",
          "inputType": "text",
          "saveConfig": {
            "key": "lyrics",
            "type": "string",
            "backendKey": "tracks",
            "backendType": "list",
            "backendSubkey": "lyrics"
          },
          "label": "Lyrics",
          "placeholder": "Enter your lyrics here...",
          "validation": {
            "required": false
          }
        },
        {
          "id": "instrumental-toggle",
          "type": "user_input",
          "inputType": "boolean",
          "saveConfig": {
            "key": "isInstrumental",
            "type": "boolean",
            "backendKey": "tracks",
            "backendType": "list",
            "backendSubkey": "isInstrumental"
          },
          "label": "Instrumental track"
        },
        {
          "id": "lyrics-actions",
          "type": "llm",
          "buttons": [
            {
              "label": "Generate lyrics with AI",
              "action": "generateLyricsWithAI",
              "returnValue": "ai_lyrics",
              "variant": "default"
            },
            {
              "label": "Skip lyrics",
              "action": "skipLyrics",
              "returnValue": "skip",
              "variant": "outline"
            }
          ],
          "activatePrompt": false,
          "activateFileUpload": false,
          "assistantMessage": {
            "content": "Now let's add lyrics to your track. You can write your own lyrics, generate them with AI, or skip this step if you want an instrumental track.",
            "showDelay": 1200,
            "enableFileInput": false,
            "enablePromptInput": true
          }
        }
      ],
      "nextStep": "track_generating",
      "autoSave": true
    },
    "track_generating": {
      "id": "track_generating",
      "stepNumber": 4,
      "bricks": [
        {
          "id": "track-generation-api",
          "type": "api_call",
          "endpoint": "/api/ai/generate-music",
          "method": "POST",
          "payload": {
            "source": "workflow_data",
            "mapping": {
              "description": "musicDescription",
              "lyrics": "lyrics",
              "isInstrumental": "isInstrumental",
              "genre": "genre"
            }
          },
          "response": {
            "saveConfig": {
              "key": "generatedTrack",
              "type": "object",
              "backendKey": "tracks",
              "backendType": "list"
            }
          },
          "onSuccess": {
            "nextStep": "video_description",
            "message": "Track generated successfully!"
          },
          "onError": {
            "message": "Failed to generate track. Please try again."
          }
        },
        {
          "id": "generation-progress",
          "type": "llm",
          "activatePrompt": false,
          "activateFileUpload": false,
          "assistantMessage": {
            "content": "Generating your music track... This may take a few minutes.",
            "showDelay": 0,
            "enableFileInput": false,
            "enablePromptInput": false
          }
        }
      ],
      "nextStep": "video_description",
      "autoSave": true
    },
    "video_description": {
      "id": "video_description",
      "stepNumber": 5,
      "bricks": [
        {
          "id": "video-description-input",
          "type": "user_input",
          "inputType": "text",
          "saveConfig": {
            "key": "videoDescription",
            "type": "string",
            "backendKey": "settings",
            "backendType": "dict"
          },
          "label": "Video Description",
          "placeholder": "Describe the visual style and content for your video...",
          "validation": {
            "required": true
          }
        },
        {
          "id": "video-description-actions",
          "type": "llm",
          "buttons": [
            {
              "label": "Generate description with AI",
              "action": "generateVideoDescriptionWithAI",
              "returnValue": "ai_description",
              "variant": "default"
            }
          ],
          "activatePrompt": false,
          "activateFileUpload": false,
          "assistantMessage": {
            "content": "Great! Now let's describe the visual style and content for your video. What kind of visuals do you want to see?",
            "showDelay": 1200,
            "enableFileInput": false,
            "enablePromptInput": true
          }
        }
      ],
      "nextStep": "reference_images",
      "autoSave": true
    },
    "reference_images": {
      "id": "reference_images",
      "stepNumber": 6,
      "bricks": [
        {
          "id": "reference-images-upload",
          "type": "user_input",
          "inputType": "file",
          "saveConfig": {
            "key": "referenceImages",
            "type": "dict",
            "backendKey": "referenceImages",
            "backendType": "dict"
          },
          "label": "Upload reference images",
          "accept": "image/*",
          "multiple": true,
          "maxFiles": 10,
          "validation": {
            "required": false
          }
        },
        {
          "id": "reference-images-actions",
          "type": "llm",
          "buttons": [
            {
              "label": "Skip reference images",
              "action": "skipReferenceImages",
              "returnValue": "skip",
              "variant": "outline"
            }
          ],
          "activatePrompt": false,
          "activateFileUpload": false,
          "assistantMessage": {
            "content": "You can upload reference images to help guide the visual style of your video, or skip this step.",
            "showDelay": 1200,
            "enableFileInput": true,
            "enablePromptInput": false
          }
        }
      ],
      "nextStep": "reference_image_description",
      "autoSave": true
    },
    "reference_image_description": {
      "id": "reference_image_description",
      "stepNumber": 7,
      "bricks": [
        {
          "id": "image-description-input",
          "type": "user_input",
          "inputType": "text",
          "saveConfig": {
            "key": "imageDescription",
            "type": "string",
            "backendKey": "settings",
            "backendType": "dict"
          },
          "label": "Image Description",
          "placeholder": "Describe the style and content of your reference images...",
          "validation": {
            "required": false
          }
        },
        {
          "id": "image-description-actions",
          "type": "llm",
          "buttons": [
            {
              "label": "Generate description with AI",
              "action": "generateImageDescriptionWithAI",
              "returnValue": "ai_description",
              "variant": "default"
            },
            {
              "label": "Skip description",
              "action": "skipImageDescription",
              "returnValue": "skip",
              "variant": "outline"
            }
          ],
          "activatePrompt": false,
          "activateFileUpload": false,
          "assistantMessage": {
            "content": "Describe the style and content of your reference images to help guide the video generation.",
            "showDelay": 1200,
            "enableFileInput": false,
            "enablePromptInput": true
          }
        }
      ],
      "nextStep": "video_styles",
      "autoSave": true
    },
    "video_styles": {
      "id": "video_styles",
      "stepNumber": 8,
      "bricks": [
        {
          "id": "style-selection",
          "type": "user_input",
          "inputType": "multiselect",
          "saveConfig": {
            "key": "selectedStyles",
            "type": "array",
            "backendKey": "settings",
            "backendType": "dict"
          },
          "label": "Select Video Styles",
          "options": [
            { "label": "Cinematic", "value": "cinematic" },
            { "label": "Animated", "value": "animated" },
            { "label": "Realistic", "value": "realistic" },
            { "label": "Abstract", "value": "abstract" },
            { "label": "Minimalist", "value": "minimalist" },
            { "label": "Vintage", "value": "vintage" }
          ],
          "validation": {
            "required": true
          }
        },
        {
          "id": "style-actions",
          "type": "llm",
          "buttons": [
            {
              "label": "Generate video",
              "action": "generateVideo",
              "returnValue": "generate",
              "variant": "default"
            }
          ],
          "activatePrompt": false,
          "activateFileUpload": false,
          "assistantMessage": {
            "content": "Select the visual styles you want for your video. You can choose multiple styles.",
            "showDelay": 1200,
            "enableFileInput": false,
            "enablePromptInput": false
          }
        }
      ],
      "nextStep": "completed",
      "autoSave": true
    },
    "completed": {
      "id": "completed",
      "stepNumber": 9,
      "bricks": [
        {
          "id": "completion-message",
          "type": "llm",
          "activatePrompt": false,
          "activateFileUpload": false,
          "assistantMessage": {
            "content": "Your music video clip workflow is complete! Your video is being generated and will be available shortly.",
            "showDelay": 0,
            "enableFileInput": false,
            "enablePromptInput": false
          }
        }
      ],
      "nextStep": "completed",
      "autoSave": true
    }
  }
}
